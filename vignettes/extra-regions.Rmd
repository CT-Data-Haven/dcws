---
title: "Extra regions"
output: rmarkdown::html_vignette
vignette: >
  %\VignetteIndexEntry{extra-regions}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---

```{r setup, include = FALSE}
knitr::opts_chunk$set(
	echo = FALSE,
	message = FALSE,
	warning = FALSE,
	collapse = TRUE,
	comment = "#>"
)
```

```{r libs}
library(dcws)
library(dplyr)
```

All the crosstab data that this package extracts are stored in the dataset `full_meta`; this isn't exported by the package, but is accessible via `dcws:::full_meta`. You won't need to use that very often, since most of the locations are included in `cws_full_data`, which *is* exported and which is filtered when you call `fetch_cws`. However, there are a few locations that we don't use very often that aren't included in `cws_full_data` just for the sake of reducing clutterâ€”mostly health districts that were only included in the survey once. On the off-chance that you do need one of those locations, the structure of `full_meta` is almost the same as `cws_full_data`, and you can filter and unnest it there.

## Differences

These are the locations & years that are in `full_meta` but not `cws_full_data`:

```{r diffs}
knitr::kable(dplyr::anti_join(
  dplyr::distinct(dcws:::full_meta, name, year),
  dplyr::distinct(cws_full_data, name, year),
  by = c("name", "year")
))
```


## Example

If you want to work with the 2021 Port Chester, NY data, you can filter `dcws:::full_meta`:

```{r example, echo=TRUE}
dcws:::full_meta %>%
  select(-path) %>%
  filter(name == "Port Chester NY", year == 2021) %>%
  tidyr::unnest(data)
```
